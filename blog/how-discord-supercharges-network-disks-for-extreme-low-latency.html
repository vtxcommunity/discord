<!DOCTYPE html><!-- Last Published: Tue Dec 19 2023 07:48:59 GMT+0000 (Coordinated Universal Time) --><html data-wf-domain="discordpages.webflow.io" data-wf-page="6102fadda3eb27bb56da0f57" data-wf-site="5f8dd67f8fdd6f51f0b50904">
<!-- Mirrored from discord.com/blog/how-discord-supercharges-network-disks-for-extreme-low-latency by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 02 Jan 2024 08:47:10 GMT -->
<head><meta charset="utf-8"/><title>How Discord Supercharges Network Disks for Extreme Low Latency</title><meta content="Learn how Discord optimizes its platform to respond to the high frequency of queries for all types of content and data as quickly as possible." name="description"/><meta content="How Discord Supercharges Network Disks for Extreme Low Latency" property="og:title"/><meta content="Learn how Discord optimizes its platform to respond to the high frequency of queries for all types of content and data as quickly as possible." property="og:description"/><meta content="https://assets-global.website-files.com/5f9072399b2640f14d6a2bf4/62fa96e012a1658e5e213eb5_Untitled.png" property="og:image"/><meta content="How Discord Supercharges Network Disks for Extreme Low Latency" property="twitter:title"/><meta content="Learn how Discord optimizes its platform to respond to the high frequency of queries for all types of content and data as quickly as possible." property="twitter:description"/><meta content="https://assets-global.website-files.com/5f9072399b2640f14d6a2bf4/62fa96e012a1658e5e213eb5_Untitled.png" property="twitter:image"/><meta property="og:type" content="website"/><meta content="summary_large_image" name="twitter:card"/><meta content="width=device-width, initial-scale=1" name="viewport"/><link href="../../assets-global.website-files.com/5f8dd67f8fdd6f51f0b50904/css/discordpages.7ab087c99.css" rel="stylesheet" type="text/css"/><script type="text/javascript">!function(o,c){var n=c.documentElement,t=" w-mod-";n.className+=t+"js",("ontouchstart"in o||o.DocumentTouch&&c instanceof DocumentTouch)&&(n.className+=t+"touch")}(window,document);</script><link href="../../assets-global.website-files.com/5f8dd67f8fdd6f51f0b50904/60ae916347747e71167e21cc_favicon.png" rel="shortcut icon" type="image/x-icon"/><link href="../../assets-global.website-files.com/5f8dd67f8fdd6f51f0b50904/5f91fae62cc821206588b837_Frame%20246.png" rel="apple-touch-icon"/><link href="rss.xml" rel="alternate" title="RSS Feed" type="application/rss+xml"/><!-- Localize integration code -->
<script src="../../ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
<script src="../../global.localizecdn.com/localize.js"></script>
<script src="../webflow-scripts/head.js"></script>
<style>
  .nav-bar-hack {
  	bottom: 0px !important;
    height: auto !important;
  }
  
  body a.w-webflow-badge {
    display: none !important;
  }
  
  body {
  	text-rendering: optimizeLegibility;
  }
  
  @media screen and (max-width: 476px) {
    .hide-on-mobile {
      display: none;
    }
  }
  
  .hr-style {
  border: 0;
  height: 8px;
  background-color: #F0F0F0;
  margin: 20px 0px;
  }
  
  .BlogBodyQuote {
  grid-column: 2/-1;
  font-size: 24px;
  line-height: 36px;
  padding: 0px 0px 15px 40px;
  font-style: italic;
  margin: 40px 0px 50px 0px;
}

.quote-text {
  width: 100%;
  margin-top: 10px;
}

.quote-icon {
  position: relative;
  top: 16px;
}

footer.quote-footer {
  font-size: 16px;
  margin-top: 20px;
  font-style: normal;
}
</style>

<style>
.language{
    display:flex;
    user-select: none;
}
.language .lang-container {
    position: relative;
}

.language .lang-selector-container {
    display: flex;
    align-items: center;
    cursor: pointer;
}

.language .locale-container{
    display: flex;
    align-items: center;
}

.language .flag {
    width: 24px;
    height: 16px;
    margin-right: 8px;
}

.language .selector-language-name{
    color: #fff;
    font-size: 14px;
    line-height: 18px;
}

.language .arrow-icon{
    padding-left: 8px;
}

.language .lang-dropdown-container {
    z-index: 10;
    bottom: 100%;
    margin-bottom: 8px;
    position: absolute;
    background-color: #fff;
    border-radius: 8px;
    box-shadow: 0 1px 1px rgb(0 0 0 / 10%);
    overflow: hidden;
    display: none;
}

.language .lang-dropdown {
    max-height: 320px;
    min-width: 150px;
    overflow-x: hidden;
    overflow-y: auto;
    overscroll-behavior: contain;
}

.language .dropdown-item{
    padding: 8px;
}

.language .dropdown-clickable{
    cursor: pointer;
}

.language .dropdown-language-name{
    color: #23272a;
    font-size: 14px;
    line-height: 18px;
}

.flag-ru{
    content:url(../../assets-global.website-files.com/5f8dd67f8fdd6f51f0b50904/6321cb4da57001e8f59b8a77_62cb46f39e6ac4c46ce39566_ru.png);
}

.flag-bg{
    content:url(../../assets-global.website-files.com/5f8dd67f8fdd6f51f0b50904/6321cdbc0dc0fb5f55e3098f_6257c2a1e7544e303083b2b1_bolg.png);
}
.flag-cs{
    content:url(../../assets-global.website-files.com/5f8dd67f8fdd6f51f0b50904/6321cb4c83827a1284afe239_62cb46f1254305732a01676d_cs.png);
}
.flag-da{
    content:url(../../assets-global.website-files.com/5f8dd67f8fdd6f51f0b50904/6321cb4ad6ee377e0df4cde6_62cb46f16128094022db6768_da.png);
}
.flag-de{
    content:url(../../assets-global.website-files.com/5f8dd67f8fdd6f51f0b50904/6321cb4aa35fe71fedf5e95f_62cb46f1c50496ce73c40d99_de.png);
}
.flag-en-GB {
    content:url("https://assets-global.website-files.com/6257adef93867e50d84d30e2/62d01c2078d11b68a1633276_Rectangle 1 (3).svg");
}
.flag-el{
    content:url(../../assets-global.website-files.com/5f8dd67f8fdd6f51f0b50904/6321cb4ca5700115ec9b8a67_62cb46f17c26b5fe5a53876f_el.png);
}
.flag-en-US{
    content:url(../../assets-global.website-files.com/5f8dd67f8fdd6f51f0b50904/6321cdbc488f5f603e7ecd2a_6257bf8b5ba300233705a542_en.png);
}
.flag-en{
    content:url(../../assets-global.website-files.com/5f8dd67f8fdd6f51f0b50904/6321cdbc488f5f603e7ecd2a_6257bf8b5ba300233705a542_en.png);
}
.flag-es{
    content:url(../../assets-global.website-files.com/5f8dd67f8fdd6f51f0b50904/6321cb4b7670687b935aaed4_62cb46f14edab1b0029593fc_es-ES.png);
}
.flag-fi{
    content:url(../../assets-global.website-files.com/5f8dd67f8fdd6f51f0b50904/6321cb48951dec0cce94a2b1_62cb46f1921c0cf82fc59da7_fi.png);
}
.flag-fr{
    content:url(../../assets-global.website-files.com/5f8dd67f8fdd6f51f0b50904/6321cb4a01339d451d474860_62cb46f1544a7ab7c66e9ccb_fr.png);
}
.flag-hi{
    content:url(../../assets-global.website-files.com/5f8dd67f8fdd6f51f0b50904/6321cb47b3070262fdccd2a6_62cb46f13fcb6e76c05b504e_hi.png);
}
.flag-hr{
    content:url(../../assets-global.website-files.com/5f8dd67f8fdd6f51f0b50904/6321cb4764813ee14c33c45f_62cb46f1aeebe9064763c90c_hr.png);
}
.flag-hu{
    content:url(../../assets-global.website-files.com/5f8dd67f8fdd6f51f0b50904/6321cb486b18c7334c564b9a_62cb46f19e6ac41dcce39561_hu.png);
}
.flag-it{
    content:url(../../assets-global.website-files.com/5f8dd67f8fdd6f51f0b50904/6321cb47fcf6b11ce186dd29_62cb46f1bd099a25f8f77ea4_it.png);
}
.flag-ja{
    content:url(../../assets-global.website-files.com/5f8dd67f8fdd6f51f0b50904/6321cb49fa4234bc13a595aa_62cb46f1e819841940bec47d_ja.png);
}
.flag-ko{
    content:url(../../assets-global.website-files.com/5f8dd67f8fdd6f51f0b50904/6321cb4b6b18c7266d564ba3_62cb46f125430509b9016776_ko.png);
}
.flag-lt{
    content:url(../../assets-global.website-files.com/5f8dd67f8fdd6f51f0b50904/6321cb4bc5fa8c17a80ae4c4_62cb46f14edab152b8959405_lt.png);
}
.flag-nl{
    content:url(../../assets-global.website-files.com/5f8dd67f8fdd6f51f0b50904/6321cb4d6b18c71a53564bac_62cb46f3e00ff80959abff2a_nl.png);
}
.flag-no{
    content:url(../../assets-global.website-files.com/5f8dd67f8fdd6f51f0b50904/6321cb4d29670fb8a9998a06_62cb46f37c26b5e22453877d_no.png);
}
.flag-pl{
    content:url(../../assets-global.website-files.com/5f8dd67f8fdd6f51f0b50904/6321cb4fd9e48ce2224e71b3_62cb46f3c504963019c40db7_pl.png);
}
.flag-pt-BR{
    content:url(../../assets-global.website-files.com/5f8dd67f8fdd6f51f0b50904/6321cb4d41e0514ceaeb0814_62cb46f3d809bc2503e62bec_pt-BR.png);
}
.flag-ro{
    content:url(../../assets-global.website-files.com/5f8dd67f8fdd6f51f0b50904/6321cb4b7b2666d9520e434e_62cb46f36e94d725ce411ab6_ro.png);
}
.flag-sv{
    content:url(../../assets-global.website-files.com/5f8dd67f8fdd6f51f0b50904/6321cb5036a202f7044eb402_62cb46f49e6ac47674e39567_sv-SE.png);
}
.flag-th{
    content:url(../../assets-global.website-files.com/5f8dd67f8fdd6f51f0b50904/6321cb502ab71d0c254b8e0c_62cb46f465c529bf26e211a1_th.png);
}
.flag-tr{
    content:url(../../assets-global.website-files.com/5f8dd67f8fdd6f51f0b50904/6321cb4f41e0515a89eb082a_62cb46f4e819848178bec4d1_tr.png);
}
.flag-uk{
    content:url(../../assets-global.website-files.com/5f8dd67f8fdd6f51f0b50904/6321cb4f36a20273d04eb401_62cb46f37c26b54f6a53877f_uk.png);
}
.flag-vi{
    content:url(../../assets-global.website-files.com/5f8dd67f8fdd6f51f0b50904/6321cb4f00801f3750f4834e_62cb46f4e819840d89bec4d2_vi.png);
}
.flag-zh-Hans{
    content:url(../../assets-global.website-files.com/5f8dd67f8fdd6f51f0b50904/6321cb5010e73af938ef607e_62cb46f49e6ac45f35e39568_zh-CN.png);
}
.flag-zh-TW{
    content:url(../../assets-global.website-files.com/5f8dd67f8fdd6f51f0b50904/6321cb4fd354ea61ac8db41c_62cb46f33fcb6ea5c95b5069_zh-TW.png);
}
</style>

<style>
.btn-wrapper a {
  color: #fff ;
}

/*
strong {
  font-weight: 700!important;
  font-size: 32px!important;
}
*/
</style>

</head><body><div style="background-color:hsla(234.93506493506493, 85.56%, 64.71%, 1.00)" class="header-blue-blog"><div data-w-id="268ebfa3-e656-b800-3b97-3f7bdfa2ec4d" class="blog-navbar"><a href="../blog.html" class="blog-brand-copy w-nav-brand"><img src="https://assets-global.website-files.com/5f8dd67f8fdd6f51f0b50904/613b8fc3834b2bd42157bc04_blogwhite.svg" loading="lazy" alt="Discord"/></a><div data-collapse="medium" data-animation="over-right" data-duration="400" data-easing="ease" data-easing2="ease" role="banner" class="navbar-5 w-nav"><div class="container-790 w-container"><nav role="navigation" class="blog-nav w-nav-menu"><div data-delay="100" data-hover="true" class="w-dropdown"><div class="w-dropdown-toggle"><img src="https://assets-global.website-files.com/5f8dd67f8fdd6f51f0b50904/635157e8f94a8580bcbb3e32_Shape.svg" loading="lazy" alt="" class="icon mobile"/><img src="https://assets-global.website-files.com/5f8dd67f8fdd6f51f0b50904/614275ac3d35134cb2a96b63_down.svg" loading="lazy" alt="" class="icon white"/><div class="blog-nav-item">COLLECTIONS</div></div><nav class="dropdown-list w-dropdown-list"><div class="w-dyn-list"><div role="list" class="w-dyn-items"><div role="listitem" class="w-dyn-item"><a href="../category/community.html" class="dropdown-link w-dropdown-link">Community</a></div><div role="listitem" class="w-dyn-item"><a href="../category/company.html" class="dropdown-link w-dropdown-link">Discord HQ</a></div><div role="listitem" class="w-dyn-item"><a href="../category/engineering.html" class="dropdown-link w-dropdown-link">Engineering &amp; Developers</a></div><div role="listitem" class="w-dyn-item"><a href="../category/how-to-discord.html" class="dropdown-link w-dropdown-link">How to Discord</a></div><div role="listitem" class="w-dyn-item"><a href="../category/safety.html" class="dropdown-link w-dropdown-link">Policy &amp; Safety</a></div><div role="listitem" class="w-dyn-item"><a href="../category/product.html" class="dropdown-link w-dropdown-link">Product &amp; Features</a></div></div></div></nav></div><a href="../blog-featured.html" class="blog-nav-item w-nav-link">Featured</a><a href="../index.html" class="blog-nav-item w-nav-link">Discord.com</a><div class="w-embed"><form action="https://discord.com/blog/search" class="form-search w-form" style="display: flex">
<input type="search" class="text-field w-input" maxlength="256" name="query" placeholder="Search…" id="search" required="">
<input type="submit" value="" class="btn-search w-button">
</form>

<style> 
form.form-search.w-form:focus-within {
    border: 1px solid #fff;
}
</style></div><form action="https://discord.com/search" class="form-search w-form"><input type="search" class="text-field w-input" maxlength="256" name="query" placeholder="Search…" id="search" required=""/><input type="submit" value="" class="btn-search w-button"/></form></nav><div class="w-nav-button"><img src="https://assets-global.website-files.com/5f8dd67f8fdd6f51f0b50904/60b6ad79b75c18f025626c71_menuicon.svg" loading="lazy" alt="Menu" class="image-14"/></div></div></div></div></div><div style="background-color:hsla(234.93506493506493, 85.56%, 64.71%, 1.00)" class="blog-home-hero-header"></div><div class="blog-featured-section"><div class="blog-hero-container hero-offset w-dyn-list"><div role="list" class="collection-list w-dyn-items"><div role="listitem" class="collection-item-4 w-dyn-item"><div class="div-block-15"><img src="../../assets-global.website-files.com/5f9072399b2640f14d6a2bf4/62fa96e012a1658e5e213eb5_Untitled.png" loading="lazy" alt="" sizes="(max-width: 767px) 92vw, (max-width: 991px) 90vw, (max-width: 1279px) 91vw, (max-width: 1919px) 92vw, 1368px" srcset="https://assets-global.website-files.com/5f9072399b2640f14d6a2bf4/62fa96e012a1658e5e213eb5_Untitled-p-500.png 500w, https://assets-global.website-files.com/5f9072399b2640f14d6a2bf4/62fa96e012a1658e5e213eb5_Untitled-p-800.png 800w, https://assets-global.website-files.com/5f9072399b2640f14d6a2bf4/62fa96e012a1658e5e213eb5_Untitled-p-1080.png 1080w, https://assets-global.website-files.com/5f9072399b2640f14d6a2bf4/62fa96e012a1658e5e213eb5_Untitled-p-1600.png 1600w, https://assets-global.website-files.com/5f9072399b2640f14d6a2bf4/62fa96e012a1658e5e213eb5_Untitled-p-2000.png 2000w, https://assets-global.website-files.com/5f9072399b2640f14d6a2bf4/62fa96e012a1658e5e213eb5_Untitled-p-2600.png 2600w, https://assets-global.website-files.com/5f9072399b2640f14d6a2bf4/62fa96e012a1658e5e213eb5_Untitled-p-3200.png 3200w, https://assets-global.website-files.com/5f9072399b2640f14d6a2bf4/62fa96e012a1658e5e213eb5_Untitled.png 3600w" class="image-19"/></div><div class="blog-hero-heading-section"><a href="../category/engineering.html" class="blog-hero-category">Engineering &amp; Developers</a><a href="how-discord-supercharges-network-disks-for-extreme-low-latency.html" aria-current="page" class="blog-hero-heading w--current">How Discord Supercharges Network Disks for Extreme Low Latency</a></div></div></div></div></div><div class="blog-post-container new"><div class="column-wrapper w-row"><div class="column-3 w-col w-col-2 w-col-stack"><div class="the-author-section"><img alt="" loading="lazy" width="72" src="../../assets-global.website-files.com/5f9072399b2640f14d6a2bf4/62fa93ea3af6e479d19e7071_Glen%20Oakley.png" sizes="72px" srcset="https://assets-global.website-files.com/5f9072399b2640f14d6a2bf4/62fa93ea3af6e479d19e7071_Glen%20Oakley-p-500.png 500w, https://assets-global.website-files.com/5f9072399b2640f14d6a2bf4/62fa93ea3af6e479d19e7071_Glen%20Oakley-p-800.png 800w, https://assets-global.website-files.com/5f9072399b2640f14d6a2bf4/62fa93ea3af6e479d19e7071_Glen%20Oakley-p-1080.png 1080w, https://assets-global.website-files.com/5f9072399b2640f14d6a2bf4/62fa93ea3af6e479d19e7071_Glen%20Oakley.png 1467w" class="image-22"/><div><div class="blog-post-author">Glen Oakley</div><div class="blog-post-author-name">August 15, 2022</div></div></div><div class="tag-section w-condition-invisible"><div class="divider-bar-copy"></div><div class="tags-sections-head">Tags</div><div class="collection-list-wrapper-2 w-dyn-list"><div class="empty-state w-dyn-empty"></div></div></div></div><div class="column-4 w-col w-col-8 w-col-stack"><div id="heading-1" class="rich-wrapper"><div class="blog-post-content w-richtext"><p>It&#x27;s no secret that Discord has become your place to talk; the 4 billion messages sent through the platform by millions of people per day have us convinced. But text chat only accounts for a chunk of the features that Discord supports. Server roles, custom emojis, video calls, and more all contribute to the hundreds of terabytes of data we serve to our users.†</p><p>To provide this enormous amount of data, we run a set of NoSQL database clusters (powered by ScyllaDB), each one the source of truth for their respective data set. As a real-time chat platform, we want our databases to respond to the high frequency of queries as fast as possible.</p><figure class="w-richtext-figure-type-image w-richtext-align-fullwidth" style="max-width:580pxpx" class="w-richtext-align-fullwidth w-richtext-figure-type-image"><div><img src="../../assets-global.website-files.com/5f9072399b2640f14d6a2bf4/62fa8baf6342b4bb5b594de7_Untitled.png" loading="lazy" alt="A line graph containing &quot;Total Requests per Second by Cluster.&quot; There are multiple unlabeled lines shown, with the biggest takeaway being that the &quot;Requests per Second&quot; are consistently hovering around 2 million."/></div><figcaption>Our databases were serving around 2 million requests per second (in this screenshot.)</figcaption></figure><h2><strong>Scaling Beyond Our Hardware</strong></h2><p>The biggest impact on our database performance is the latency of individual disk operations - how long it takes to read or write data from the physical hardware. Below a certain database query rate, disk latency isn&#x27;t noticeable, as our databases do a great job of handling requests in parallel (not blocking on a single disk operation). But this parallelism is limited; at a certain threshold, the database will need to wait for an outstanding disk operation to complete before it will issue another. If you combine this with disks that take a millisecond or two to complete an operation, the database eventually reaches a point where it can no longer immediately fetch data for incoming queries. This causes disk operations and queries to &quot;back up&quot;, slowing the response to the client who issued the query, which in turn causes poor application performance. In the worst case, this can cascade into an ever-expanding queue of disk operations whose queries time out by the time the disk is available. This is exactly what we were seeing on our own servers—the database would report an ever-growing queue of disk reads and queries would start timing out.</p><p>But wait: A millisecond or two to complete a disk operation? Why are we seeing this behavior when disk latency can usually be measured in microseconds?</p><p>Discord runs most of its hardware in Google Cloud and they provide ready access to “Local SSDs” — NVMe based instance storage, which do have incredibly fast latency profiles. Unfortunately, in our testing, we ran into enough reliability issues that we didn’t feel comfortable with depending on this solution for our critical data storage. This took us back to the drawing board — how do we get incredibly low latency when we can’t rely on the super-fast on-device storage?</p><p>The other main means of instance storage in GCP is called Persistent Disks. These are disks that can be attached/detached from servers on the fly, can be resized without downtime, can generate point-in-time snapshots at any time, and are replicated by design (to prevent data loss in the event that a single piece of hardware dies). The downside is that these disks are not attached directly to a server, but are connected from a somewhat-nearby location (probably the same building as the server) via the network.</p><p>While latency over a local network connection is low, it&#x27;s nowhere near as low as over a PCI or SATA connection that spans less than a meter. This means that the average latency of disk operations (from the perspective of the operating system) can be on the order of a couple milliseconds, compared to half a millisecond for directly-attached disks.</p><figure class="w-richtext-figure-type-image w-richtext-align-fullwidth" style="max-width:undefinedpx" class="w-richtext-align-fullwidth w-richtext-figure-type-image"><div><img src="../../assets-global.website-files.com/5f9072399b2640f14d6a2bf4/62fa8c8fc8a25b2ae703b096_Untitled.png" alt="A line graph labeled &quot;Disk latency, milliseconds, by device.&quot; It contains two lines: The &quot;Persistent Disk&quot; line is erratic, with the line rapily moving between 1 millisecond and 2 milliseconds. The &quot;Local Disk&quot; line is consistently round half a millisecond."/></div></figure><p>Local SSDs have other concerns, as well. As with traditional hard drives, the downside is that a hardware issue with one of these disks (or a disk controller) means we immediately lose everything on that disk. But worse than with traditional hard drives is what happens when the <em>host</em> has problems; if the host to which the Local SSDs are attached has critical issues, the disks and their data are gone forever. We also lose the ability to create point-in-time snapshots of an entire disk, which is critical for certain workflows at Discord (like some data backups). These missing features are why nearly all Discord servers are powered by Persistent Disks instead of Local SSDs.</p><h2><strong><br/>Evaluating the Problem</strong></h2><p>In a perfect world, we&#x27;d power our databases with a disk that combined the best properties of Persistent Disks and Local SSDs. Unfortunately no such disk exists, at least not within the ecosystem of common cloud providers. Asking for low latency directly-attached disks removes the abstraction that gives Persistent Disks their amazing flexibility.</p><p>But what if we didn&#x27;t need <em>all</em> of that flexibility? For instance, write latency isn&#x27;t critical for our workloads—it&#x27;s read latency that has the biggest impact on application performance (due to our read-heavy workloads). And resizing disks without downtime isn&#x27;t an important feature - we can better estimate our storage growth and provision larger disks ahead of time.</p><figure class="w-richtext-figure-type-image w-richtext-align-fullwidth" style="max-width:580pxpx" class="w-richtext-align-fullwidth w-richtext-figure-type-image"><div><img src="../../assets-global.website-files.com/5f9072399b2640f14d6a2bf4/62fa8ca5c227ca1dd5478335_Untitled.png" alt="A line graph labeled &quot;Disk Operations Per Second.&quot; There are two lines on this chart, with &quot;Reads&quot; hovering between 1.25 million and 1.5 million Reads Per Second. The &quot;Writes&quot; line is hovering around .1 million &quot;Writes Per Second.&quot;"/></div></figure><p>‍</p><p>After thinking through what was most valuable for the operation of our databases, we narrowed down the requirements for solving our database woes:</p><ul role="list"><li>Stay within Google Cloud (i.e. leverage GCP&#x27;s disk offerings)</li><li>Continue using point-in-time snapshotting for data backups</li><li>Prioritize low-latency disk reads over all other disk metrics</li><li>Do not sacrifice existing database uptime guarantees</li></ul><p>The different GCP disk types each meet these requirements in different ways. It would be all too convenient if we could combine both disk types into one super-disk. Since our primary focus for disk performance was low-latency reads, we would love to read from GCP&#x27;s Local SSDs (low latency) while still writing to Persistent Disks (snapshotting, redundancy via replication). But is there a way to create such a super-disk at the software level?</p><h2><strong><br/>Creating the Super-Disk</strong></h2><p>What we&#x27;d described with our requirement was essentially a write-through cache, with GCP&#x27;s Local SSDs as the cache and Persistent Disks as the storage layer. We run Ubuntu on our database servers, so we were fortunate to find that the Linux kernel is able to cache data at the disk level in a variety of ways, providing modules such as <em>dm-cache</em>, <em>lvm-cache</em>, and <em>bcache</em>.</p><p>Unfortunately, our experimentation with caching led us to discover a couple pitfalls. The biggest one was how failures in the cache disk were handled: Reading a bad sector from the cache caused the entire read operation to fail. Local SSDs, a thin layer on top of NVMe SSD hardware, suffer from bad sectors like any other physical disk. These bad sectors can be fixed by overwriting the sector on the cache with data from the storage layer, but the disk caching solutions we evaluated either didn&#x27;t have this capability or required more complex configuration than we wanted to consider during this phase of research. Without the cache fixing bad sectors, they will be exposed to the calling application, and our databases will shutdown for data safety reasons when encountering bad sector reads:</p><blockquote><em>storage_service - Shutting down communications due to I/O errors until operator intervention<br/>storage_service - Disk error: std::system_error (error system:61, No data available)</em></blockquote><p>With our requirements updated to include &quot;Survive bad sectors on the Local SSD&quot;, we investigated an entirely different type of Linux kernel system: <em>md</em></p><p><em>md</em> allows Linux to create software RAID arrays, turning multiple disks into one &quot;array&quot; (virtual disk). A simple mirrored (RAID1) array between Local SSDs and Persistent Disks would not solve our problem; reads would still hit the Persistent Disks for about half of all operations. However, <em>md</em> offers additional features not present in a traditional RAID controller, one of which is &quot;write-mostly&quot;. The kernel man pages give the best summary of this feature:</p><blockquote><em>Individual devices in a RAID1 can be marked as &quot;write-mostly&quot;. These drives are excluded from the normal read balancing and will only be read from when there is no other option. This can be useful for devices connected over a slow link.</em></blockquote><p>Since &quot;devices connected over a slow link&quot; just happens to be a perfect description of Persistent Disks, this looked like a viable strategy for proceeding with building a super-disk. A RAID1 array containing a Local SSD and a Persistent Disk set to write-mostly would meet all our requirements.</p><p>One last problem remained: Local SSDs in GCP are exactly 375GB in size. Discord requires a terabyte or more of storage per database instance for certain applications, so this is nowhere near enough space. We could attach multiple Local SSDs to a server, but we needed a way to turn a bunch of smaller disks into one larger disk.</p><figure class="w-richtext-figure-type-image w-richtext-align-fullwidth" style="max-width:584pxpx" class="w-richtext-align-fullwidth w-richtext-figure-type-image"><div><img src="../../assets-global.website-files.com/5f9072399b2640f14d6a2bf4/62fa8e1dfb24ac7e3bc84e10_Untitled.png" alt="A bar graph called &quot;Disk Used,&quot; showing how much Data is stored. While there are dozens of tiny lines, the main point of the graph is to show total amount of storage used, which is just under 768 Tebibytes of storage."/></div></figure><p>‍</p><p><em>md</em> offers a number of RAID configurations that stripe data across multiple disks. The simplest method, RAID0, splits raw data across all disks, and if one disk is lost, the entire array fails and all data is lost. More complex methods (RAID5, RAID6) maintain parity and allow the loss of at least one disk at the cost of performance penalties. This is great for maintaining uptime—just remove the failed disk and replace it with a fresh one. But in the GCP world, there is no concept of replacing a Local SSD - these are devices located deep inside Google data centers. In addition, GCP provides an interesting &quot;guarantee&quot; around the failure of Local SSDs: If any Local SSD fails, the entire server is migrated to a different set of hardware, essentially erasing all Local SSD data for that server. Since we don&#x27;t (can&#x27;t) worry about replacing Local SSDs, and to reduce the performance impact of striped RAID arrays, we settled on RAID0 as our strategy to turn multiple Local SSDs into one low-latency virtual disk.</p><p>With a RAID0 on top of the Local SSDs, and a RAID1 between the Persistent Disk and RAID0 array, we could configure the database with a disk drive that would offer low-latency reads, while still allowing us to benefit from the best properties of Persistent Disks.</p><figure class="w-richtext-figure-type-image w-richtext-align-fullwidth" style="max-width:622pxpx" class="w-richtext-align-fullwidth w-richtext-figure-type-image"><div><img src="../../assets-global.website-files.com/5f9072399b2640f14d6a2bf4/62fa8e85b2bb02210f63f001_Untitled.png" alt="A chart displaying how Hardware and md interact. On Hardware’s Local SSD, four NVME drives interact with “mb0” on RAID0, then flow to “md1” on RAID1. As an alternate pathway, “Persistent Disk” on Hardware can “write-mostly” to “md1” on RAID1 directly, bypassing md0 on RAID0. "/></div></figure><h2><strong><br/>Database Performance</strong></h2><p>This new disk configuration looked good in testing, but how would it behave with an actual database on top of it?</p><p>We saw exactly what we expected - at peak load, our databases no longer started queueing up disk operations, and we saw no change in query latency. In practice, this means our metrics show fewer outstanding database disk reads on super-disks than on Persistent Disks, due to less time spent on I/O operations.</p><figure class="w-richtext-figure-type-image w-richtext-align-fullwidth" style="max-width:892pxpx" class="w-richtext-align-fullwidth w-richtext-figure-type-image"><div><img src="../../assets-global.website-files.com/5f9072399b2640f14d6a2bf4/62fa8e97c47c385a1c87a868_iowait.png" alt="A line chart called “System iowait,” showing the times that Disks were spend idle before a new action was taken.” Persistent Disk is hovering around “8e-3,” while Super-Disk” sticker between “4e-3” and “2e-3.”"/></div></figure><p>These performance increases let us squeeze more queries onto the same servers, which is great news for those of us maintaining the database servers (and for the finance department).<br/>‍</p><h2>Conclusion</h2><p>In retrospect, disk latency should have been an obvious concern early on in our database deployments. The world of cloud computing causes so many systems to behave in ways that are nothing like their physical data center counterparts. The research and testing that went into developing our super-disk solution gave us many useful performance metrics to monitor, taught the team about the inner workings of disk devices (in both Linux and GCP), and improved our culture of testing and validating architectural changes. With super-disks introduced to production, our databases have continued to scale with the growth of Discord&#x27;s user base.</p><p>Anyone who has ever worked with RAID before might be suspicious that such a setup would “just work” - there are a lot of systems at play in a cloud environment that can fail in fascinating new ways.  There is more happening to support this disk setup than just a single <em>md</em> configuration.  Expect a part two to this blog post that will go into more detail about the specific edge cases we’ve run into in the cloud environment and how we’ve solved them.</p><p>Lastly, if you like what you see here, come join us! We are hiring!</p></div></div><div class="btn-wrapper"><a href="../careers.html?team=engineering" class="btn-blog w-button">Browse Careers at Discord</a></div><div id="heading-2" class="rich-wrapper"><div class="blog-post-content w-richtext"><p> </p></div></div><div id="heading-3" class="rich-wrapper"><div class="blog-post-content w-dyn-bind-empty w-richtext"></div></div><div id="heading-4" class="rich-wrapper"><div class="blog-post-content w-dyn-bind-empty w-richtext"></div></div><div id="heading-5" class="rich-wrapper"><div class="blog-post-content w-dyn-bind-empty w-richtext"></div></div><div id="heading-6" class="rich-wrapper"><div class="blog-post-content w-dyn-bind-empty w-richtext"></div></div><div id="heading-7" class="rich-wrapper"><div class="blog-post-content w-dyn-bind-empty w-richtext"></div></div><div id="heading-8" class="rich-wrapper"><div class="blog-post-content w-dyn-bind-empty w-richtext"></div></div><div id="heading-9" class="rich-wrapper"><div class="blog-post-content w-dyn-bind-empty w-richtext"></div></div><div id="heading-10" class="rich-wrapper"><div class="blog-post-content w-dyn-bind-empty w-richtext"></div></div></div><div class="column-desctop w-condition-invisible w-col w-col-2 w-col-stack"><div class="rich-content-right"><div class="paragraph-medium bot-marg">Contents</div><a href="#heading-1" class="title-menu-anchor w-dyn-bind-empty"></a><a href="#heading-2" class="title-menu-anchor w-dyn-bind-empty"></a><a href="#heading-3" class="title-menu-anchor w-dyn-bind-empty"></a><a href="#heading-4" class="title-menu-anchor w-dyn-bind-empty"></a><a href="#heading-5" class="title-menu-anchor w-dyn-bind-empty"></a><a href="#heading-6" class="title-menu-anchor w-dyn-bind-empty"></a><a href="#heading-7" class="title-menu-anchor w-dyn-bind-empty"></a><a href="#heading-8" class="title-menu-anchor w-dyn-bind-empty"></a><a href="#heading-9" class="title-menu-anchor w-dyn-bind-empty"></a><a href="#heading-10" class="title-menu-anchor w-dyn-bind-empty"></a></div></div></div><div class="divider-bar"></div><div class="blog-column w-row"><div class="w-col w-col-3 w-col-medium-6"><div class="author-title">THE AUTHOR</div></div><div class="w-col w-col-9 w-col-medium-6"><div class="the-author-section footer"><img alt="" loading="lazy" width="47" src="../../assets-global.website-files.com/5f9072399b2640f14d6a2bf4/62fa93ea3af6e479d19e7071_Glen%20Oakley.png" sizes="96px" srcset="https://assets-global.website-files.com/5f9072399b2640f14d6a2bf4/62fa93ea3af6e479d19e7071_Glen%20Oakley-p-500.png 500w, https://assets-global.website-files.com/5f9072399b2640f14d6a2bf4/62fa93ea3af6e479d19e7071_Glen%20Oakley-p-800.png 800w, https://assets-global.website-files.com/5f9072399b2640f14d6a2bf4/62fa93ea3af6e479d19e7071_Glen%20Oakley-p-1080.png 1080w, https://assets-global.website-files.com/5f9072399b2640f14d6a2bf4/62fa93ea3af6e479d19e7071_Glen%20Oakley.png 1467w" class="blog-post-author-image-footer"/><div><div class="blog-post-author-footer">Glen Oakley</div><div class="blog-post-author-desc">Glen is a senior site reliability engineer at Discord working to support the SRE team’s mission to maintain the reliability and resilience of Discord user experiences in production without sacrificing people to do it.</div></div></div></div></div><div class="divider-bar"></div><div><div class="author-title">MORE FROM</div><div class="category-title-footer">Engineering &amp; Developers</div><div class="footer-more-from w-dyn-list"><div role="list" class="featured-small-list w-dyn-items w-row"><div role="listitem" class="collection-item-small blog w-dyn-item w-col w-col-4"><a href="pytest-daemon-10x-local-test-iteration-speed.html" class="link-block-4 w-inline-block"><img src="../../assets-global.website-files.com/5f9072399b2640f14d6a2bf4/6555194328bacbf541b78da4_Engineering%20-%202%20(1).png" loading="lazy" alt="" sizes="(max-width: 767px) 83vw, (max-width: 991px) 29vw, (max-width: 1439px) 30vw, 434.6625061035156px" srcset="https://assets-global.website-files.com/5f9072399b2640f14d6a2bf4/6555194328bacbf541b78da4_Engineering%20-%202%20(1)-p-500.png 500w, https://assets-global.website-files.com/5f9072399b2640f14d6a2bf4/6555194328bacbf541b78da4_Engineering%20-%202%20(1)-p-800.png 800w, https://assets-global.website-files.com/5f9072399b2640f14d6a2bf4/6555194328bacbf541b78da4_Engineering%20-%202%20(1)-p-1080.png 1080w, https://assets-global.website-files.com/5f9072399b2640f14d6a2bf4/6555194328bacbf541b78da4_Engineering%20-%202%20(1)-p-1600.png 1600w, https://assets-global.website-files.com/5f9072399b2640f14d6a2bf4/6555194328bacbf541b78da4_Engineering%20-%202%20(1)-p-2000.png 2000w, https://assets-global.website-files.com/5f9072399b2640f14d6a2bf4/6555194328bacbf541b78da4_Engineering%20-%202%20(1)-p-2600.png 2600w, https://assets-global.website-files.com/5f9072399b2640f14d6a2bf4/6555194328bacbf541b78da4_Engineering%20-%202%20(1)-p-3200.png 3200w, https://assets-global.website-files.com/5f9072399b2640f14d6a2bf4/6555194328bacbf541b78da4_Engineering%20-%202%20(1).png 3600w" class="blog-featured-small-image"/></a><a href="../category/engineering.html" class="blog-hero-category">Engineering &amp; Developers</a><a href="pytest-daemon-10x-local-test-iteration-speed.html" class="link-block-20 w-inline-block"><div class="blog-featured-title-small">pytest daemon: 10X Local Test Iteration Speed</div></a></div><div role="listitem" class="collection-item-small blog w-dyn-item w-col w-col-4"><a href="ddevs-celebrates-250k-members.html" class="link-block-4 w-inline-block"><img src="../../assets-global.website-files.com/5f9072399b2640f14d6a2bf4/65690639d911b0d8f5dc758e_DDevs_250k_blogheader.png" loading="lazy" alt="" sizes="(max-width: 767px) 83vw, (max-width: 991px) 29vw, (max-width: 1439px) 30vw, 434.6625061035156px" srcset="https://assets-global.website-files.com/5f9072399b2640f14d6a2bf4/65690639d911b0d8f5dc758e_DDevs_250k_blogheader-p-500.png 500w, https://assets-global.website-files.com/5f9072399b2640f14d6a2bf4/65690639d911b0d8f5dc758e_DDevs_250k_blogheader-p-800.png 800w, https://assets-global.website-files.com/5f9072399b2640f14d6a2bf4/65690639d911b0d8f5dc758e_DDevs_250k_blogheader-p-1080.png 1080w, https://assets-global.website-files.com/5f9072399b2640f14d6a2bf4/65690639d911b0d8f5dc758e_DDevs_250k_blogheader-p-1600.png 1600w, https://assets-global.website-files.com/5f9072399b2640f14d6a2bf4/65690639d911b0d8f5dc758e_DDevs_250k_blogheader.png 1800w" class="blog-featured-small-image"/></a><a href="../category/engineering.html" class="blog-hero-category">Engineering &amp; Developers</a><a href="ddevs-celebrates-250k-members.html" class="link-block-20 w-inline-block"><div class="blog-featured-title-small">The DDevs Server Celebrates 250k Members!</div></a></div><div role="listitem" class="collection-item-small blog w-dyn-item w-col w-col-4"><a href="authentication-outage.html" class="link-block-4 w-inline-block"><img src="../../assets-global.website-files.com/5f9072399b2640f14d6a2bf4/63178bf5d9f1714116f6a66d_Resources%20%26%20Education%20-%203.png" loading="lazy" alt="" sizes="(max-width: 767px) 83vw, (max-width: 991px) 29vw, (max-width: 1439px) 30vw, 434.6625061035156px" srcset="https://assets-global.website-files.com/5f9072399b2640f14d6a2bf4/63178bf5d9f1714116f6a66d_Resources%20%26%20Education%20-%203-p-500.png 500w, https://assets-global.website-files.com/5f9072399b2640f14d6a2bf4/63178bf5d9f1714116f6a66d_Resources%20%26%20Education%20-%203-p-800.png 800w, https://assets-global.website-files.com/5f9072399b2640f14d6a2bf4/63178bf5d9f1714116f6a66d_Resources%20%26%20Education%20-%203-p-1080.png 1080w, https://assets-global.website-files.com/5f9072399b2640f14d6a2bf4/63178bf5d9f1714116f6a66d_Resources%20%26%20Education%20-%203-p-1600.png 1600w, https://assets-global.website-files.com/5f9072399b2640f14d6a2bf4/63178bf5d9f1714116f6a66d_Resources%20%26%20Education%20-%203-p-2000.png 2000w, https://assets-global.website-files.com/5f9072399b2640f14d6a2bf4/63178bf5d9f1714116f6a66d_Resources%20%26%20Education%20-%203-p-2600.png 2600w, https://assets-global.website-files.com/5f9072399b2640f14d6a2bf4/63178bf5d9f1714116f6a66d_Resources%20%26%20Education%20-%203-p-3200.png 3200w, https://assets-global.website-files.com/5f9072399b2640f14d6a2bf4/63178bf5d9f1714116f6a66d_Resources%20%26%20Education%20-%203.png 3600w" class="blog-featured-small-image"/></a><a href="../category/engineering.html" class="blog-hero-category">Engineering &amp; Developers</a><a href="authentication-outage.html" class="link-block-20 w-inline-block"><div class="blog-featured-title-small">25% or 6 to 4: The 11/6/23 Authentication Outage</div></a></div></div></div></div></div><div class="footer-black"><div class="container-1180px-2"><div class="w-layout-grid grid-footer"><div id="w-node-_4154f574-5821-8ddb-f6fc-12aae7b6c861-e7b6c85e" class="vertical-flex"><div data-hover="false" data-delay="0" class="dropdown-3 w-dropdown"><div class="dropdown-toggle w-dropdown-toggle"><img src="https://assets-global.website-files.com/6257adef93867e50d84d30e2/6257bee91e6309a5a6f6b994_arrow.svg" loading="lazy" alt="" class="arrow"/><div>English, USA</div></div><nav class="dropdown-list-5 w-dropdown-list"><a href="#" class="dropdown-link-2 w-dropdown-link">български</a><a href="#" class="dropdown-link-2 czech w-dropdown-link">Čeština</a><a href="#" class="dropdown-link-2 dansk w-dropdown-link">Dansk</a><a href="#" class="dropdown-link-2 deutsch w-dropdown-link">Deutsch</a><a href="#" class="dropdown-link-2 greek w-dropdown-link">Ελληνικά</a><a href="#" class="dropdown-link-2 english w-dropdown-link">English, USA</a><a href="#" class="dropdown-link-2 spanish w-dropdown-link">Español</a><a href="#" class="dropdown-link-2 suomi w-dropdown-link">Suomi</a><a href="#" class="dropdown-link-2 french w-dropdown-link">Français</a><a href="#" class="dropdown-link-2 hindi w-dropdown-link">हिंदी</a><a href="#" class="dropdown-link-2 hrvatski w-dropdown-link">Hrvatski</a><a href="#" class="dropdown-link-2 magyar w-dropdown-link">Magyar</a><a href="#" class="dropdown-link-2 italiano w-dropdown-link">Italiano</a><a href="#" class="dropdown-link-2 japanese w-dropdown-link">日本語</a><a href="#" class="dropdown-link-2 korean w-dropdown-link">한국어</a><a href="#" class="dropdown-link-2 lithuanian w-dropdown-link">Lietuviškai</a><a href="#" class="dropdown-link-2 nederlands w-dropdown-link">Nederlands</a><a href="#" class="dropdown-link-2 norwegian w-dropdown-link">Norwegian</a><a href="#" class="dropdown-link-2 polski w-dropdown-link">Polski</a><a href="#" class="dropdown-link-2 brazilian-portuguese w-dropdown-link">Português do Brasil</a><a href="#" class="dropdown-link-2 romania w-dropdown-link">Română</a><a href="#" class="dropdown-link-2 ru w-dropdown-link">Русский</a><a href="#" class="dropdown-link-2 svenska w-dropdown-link">Svenska</a><a href="#" class="dropdown-link-2 thai w-dropdown-link">ไทย</a><a href="#" class="dropdown-link-2 turkey w-dropdown-link">Türkçe</a><a href="#" class="dropdown-link-2 ua w-dropdown-link">Українська</a><a href="#" class="dropdown-link-2 vietnamese w-dropdown-link">Tiếng Việt</a><a href="#" class="dropdown-link-2 chinese1 w-dropdown-link">中文</a><a href="#" class="dropdown-link-2 chinese w-dropdown-link">繁體中文</a></nav></div><div class="language"><div class="lang-container"><div id="locale-dropdown" class="lang-dropdown-container"><div class="lang-dropdown"></div></div><div class="lang-selector-container"><div class="locale-container"><img src="https://assets-global.website-files.com/plugins/Basic/assets/placeholder.60f9b1840c.svg" alt="" class="flag"/><div class="selector-language-name"></div></div><img src="https://assets-global.website-files.com/6257adef93867e50d84d30e2/6257bee91e6309a5a6f6b994_arrow.svg" loading="lazy" alt="" class="arrow-icon"/></div></div></div><div class="flex-horizontal top-soc"><a data-track="twitter" href="https://twitter.com/discord" target="_blank" class="link-s w-inline-block"><img src="https://assets-global.website-files.com/5f8dd67f8fdd6f51f0b50904/65814ad8d9f0b3d89c08fdad_X.svg" loading="lazy" alt="" class="image-49"/></a><a data-track="instagram" href="https://www.instagram.com/discord/" target="_blank" class="link-s w-inline-block"><img src="https://assets-global.website-files.com/6238e97f6441e30a13a52345/6436b5ef634f834a45100cff_svg4.svg" loading="lazy" alt="" class="image-49"/></a><a data-track="facebook" href="https://www.facebook.com/discord/" target="_blank" class="link-s w-inline-block"><img src="https://assets-global.website-files.com/6238e97f6441e30a13a52345/6436b5ef634f836372100cfc_svg5.svg" loading="lazy" alt="" class="image-49"/></a><a data-track="youtube" href="https://www.youtube.com/discord" target="_blank" class="link-s w-inline-block"><img src="https://assets-global.website-files.com/6238e97f6441e30a13a52345/6436b5ef634f83240a100cfe_svg6.svg" loading="lazy" alt="" class="image-49"/></a><a data-track="Tiktok" href="https://www.tiktok.com/@discord" target="_blank" class="link-s w-inline-block"><img src="https://assets-global.website-files.com/6257adef93867e50d84d30e2/6374a8122d8df285ddea0e9e_Tiktok (1).svg" loading="lazy" alt="" class="image-49"/></a></div></div><div id="w-node-_4154f574-5821-8ddb-f6fc-12aae7b6c8b6-e7b6c85e"><div class="paragraph-small top-marg font-blue">Product</div><a data-track="download" href="../download.html" class="link-footer">Download</a><a data-track="nitro" href="../nitro.html" class="link-footer">Nitro</a><a data-track="status" href="https://discordstatus.com/" class="link-footer">Status</a><a data-track="status" href="../application-directory.html" class="link-footer">App Directory</a><a data-track="status" href="../mobile.html" class="link-footer">New Mobile Experience</a></div><div id="w-node-_4154f574-5821-8ddb-f6fc-12aae7b6c8bf-e7b6c85e"><div class="paragraph-small top-marg font-blue">Company</div><a data-track="about" href="../company.html" class="link-footer">About</a><a data-track="jobs" href="../careers.html" class="link-footer">Jobs</a><a data-track="branding" href="../branding.html" class="link-footer">Brand</a><a data-track="newsroom" href="../newsroom.html" class="link-footer">Newsroom</a><a data-track="newsroom" href="../fallrelease.html" class="link-footer">Fall Release</a></div><div id="w-node-_4154f574-5821-8ddb-f6fc-12aae7b6c8ca-e7b6c85e"><div class="paragraph-small top-marg font-blue">Resources</div><a data-track="college" href="../college.html" class="link-footer">College</a><a data-track="support" href="https://support.discord.com/hc" class="link-footer">Support</a><a data-track="safety" href="../safety.html" class="link-footer">Safety</a><a data-track="blog" href="../blog.html" class="link-footer">Blog</a><a data-track="feedback" href="https://support.discord.com/hc/en-us/community/topics" class="link-footer">Feedback</a><a data-track="streamkit" href="../streamkit.html" class="link-footer">StreamKit</a><a data-track="creators" href="../creators.html" class="link-footer">Creators</a><a data-track="community" href="../community.html" class="link-footer">Community</a><a data-track="Build" href="../build.html" class="link-footer">Developers</a><a data-track="Build" href="../gaming.html" class="link-footer">Gaming</a><a data-track="store" href="https://discordmerch.com/evergreenfooter" class="link-footer">Official 3rd Party Merch</a></div><div id="w-node-_4154f574-5821-8ddb-f6fc-12aae7b6c8e1-e7b6c85e"><div class="paragraph-small top-marg font-blue">Policies</div><a data-track="terms" href="../terms.html" class="link-footer">Terms</a><a data-track="privacy" href="../privacy.html" class="link-footer">Privacy</a><a data-open-cookie-settings="true" href="#" class="link-footer">Cookie Settings</a><a data-track="guidelines" href="../guidelines.html" class="link-footer">Guidelines</a><a data-track="acknowledgement" href="../acknowledgements.html" class="link-footer">Acknowledgements</a><a data-track="licenses" href="../licenses.html" class="link-footer">Licenses</a><a data-track="moderation" href="../safety-library.html" class="link-footer">Moderation</a></div></div><div class="footer-line-blue"><a data-track="logo" href="../index.html" class="w-inline-block"><img src="https://assets-global.website-files.com/5f8dd67f8fdd6f51f0b50904/64cb9ed63bb88490555f45a1_Open Source Projects _ Discord-7.svg" loading="lazy" alt="" class="discord-footer"/></a><a data-track="login_footer" href="../app.html" class="button-white color-blue-right footer-open-discord-button footer-open-discord-button-js w-button">Sign up</a></div></div></div><script src="../../d3e54v103j8qbb.cloudfront.net/js/jquery-3.5.1.min.dc5e7f18c84fb4.js?site=5f8dd67f8fdd6f51f0b50904" type="text/javascript" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script><script src="../../assets-global.website-files.com/5f8dd67f8fdd6f51f0b50904/js/discordpages.790f5716f.js" type="text/javascript"></script><script type="text/javascript" src="../w/loader/loader.js" async defer></script>
<script src="../webflow-scripts/bodyEnd.js" defer async></script>
<script>
  function initDownloadButton() {
    let userAgent = window.navigator.userAgent,
        platform = window.navigator.platform,
        macosPlatforms = ['Macintosh', 'MacIntel', 'MacPPC', 'Mac68K'],
        windowsPlatforms = ['Win32', 'Win64', 'Windows', 'WinCE'],
        iosPlatforms = ['iPhone', 'iPad', 'iPod'],
        buttonAttributes = null;

    if (iosPlatforms.indexOf(platform) !== -1) {
      buttonAttributes = {
        text: "Download on the App Store",
        href: "https://itunes.apple.com/us/app/discord-chat-for-games/id985746746",
      }
    } else if (macosPlatforms.indexOf(platform) !== -1) {
      buttonAttributes = {
        text: "Download for Mac",
        href: "https://discord.com/api/download?platform=osx",
      }
    } else if (windowsPlatforms.indexOf(platform) !== -1) {
      buttonAttributes = {
        text: "Download for Windows",
        href: "https://discord.com/api/download?platform=win",
      }
    } else if (/Android/.test(userAgent)) {
      buttonAttributes = {
        text: "Download on Google Play",
        href: "https://play.google.com/store/apps/details?id=com.discord",
      }
    } else if (!os && /Linux/.test(platform)) {
      buttonAttributes = {
        text: "Download for Linux",
        href: "https://discord.com/api/download?platform=linux",
      }
    }

	let downloadEl = document.querySelectorAll(".download-button");
    if (downloadEl) {
      downloadEl.forEach(function(el) {
        el.innerText = buttonAttributes.text;
        el.href = buttonAttributes.href;
      });
    }

	let downloadSidebarEl = document.querySelectorAll(".download-sidebar");
    if (downloadSidebarEl) {
      downloadSidebarEl.forEach(function(el) {
        el.href = buttonAttributes.href;
      });
    }
  }
  
  function initLogInOrOpenDiscordButton() {
    let loginButtonText, loginRoute, signUpButtonText, signupRoute;
    let loginIsOpenDiscordButton = true;
    const loginLink = '../login.html';
    const signupLink = '../register.html';
    const openLink = '../channels/%40me.html';
    
    if(window.localStorage.getItem("token") != null) {
      loginButtonText = "Open Discord";
      loginRoute = openLink;
      loginIsOpenDiscordButton = true;
      
      signUpButtonText = "Open Discord";
      signupRoute = openLink;
    } else {
      loginIsOpenDiscordButton = false;
      loginButtonText = "Login";
      signUpButtonText = "Sign up";
      loginRoute = loginLink;
      signupRoute = signupLink;
    }
    
    let loginEl = document.querySelectorAll(".login-button-js");
    let footerEl = document.querySelectorAll(".footer-open-discord-button-js");
    if (loginEl && loginEl.length > 0) {
      loginEl.forEach(function(el) {
        if (!loginIsOpenDiscordButton) {
        	el.classList.add('hide-on-mobile');
        }
        el.innerText = loginButtonText;
      	el.href = loginRoute;
        if (loginIsOpenDiscordButton) {
            el.dataset.trackNav = 'navbar-open-button';
        }
      });
    }
    if (footerEl && footerEl.length > 0) {
      footerEl.forEach(function(el) {
        if (window.innerWidth <= 768) {
        	el.innerText = "Download";
        } else {
        	el.innerText = signUpButtonText;
        }
        el.href = signupRoute;
      });
    }
  }
  
  function initSignUpOrOpenButtons() {
    const signupLink = '../register.html';
    const openLink = '../channels/%40me.html';
    const isLoggedIn = window.localStorage.getItem("token") != null;
    const buttonEl = document.querySelectorAll(".open-or-signup-js");
    
    if (buttonEl && buttonEl.length > 0) {
        buttonEl.forEach(function(el) {
            if (isLoggedIn) {
                el.innerText = 'Open Discord';
                el.href = openLink;
            } else {
                el.innerText = 'Sign up';
                el.href = signupLink;
            }
        });
    }
  }
  
  initSignUpOrOpenButtons();
  initLogInOrOpenDiscordButton();
  initDownloadButton();
</script>


<!-- build:inlineScriptNonceTag -->
  <script>
  <!-- endbuild -->
  </script>
  <!-- section:dataLayer -->
  <script src="../assets/oneTrust/v4/scripttemplates/otSDKStub.js" type="text/javascript" charset="UTF-8" data-domain-script="04da1d72-0626-4fff-b3c6-150c719cc115"></script>
  <!-- build:inlineScriptNonceTag -->
  <script>
    <!-- endbuild -->
    window.dataLayer = window.dataLayer || [];
    window.dataLayer.push({ 'allCookiesOK': false });
  </script>
  <!-- endsection -->
  <!-- section:gtm -->
  <!-- build:inlineScriptNonceTag -->
  <script>
  <!-- endbuild -->
    (function (w, d, s, l, i) {
      w[l] = w[l] || []; w[l].push({
        'gtm.start':
          new Date().getTime(), event: 'gtm.js'
      }); var f = d.getElementsByTagName(s)[0],
        j = d.createElement(s), dl = l != 'dataLayer' ? '&l=' + l : ''; j.async = true; j.src =
          '../../www.googletagmanager.com/gtm5445.html?id=' + i + dl + '&gtm_auth=GI0g9O-54_SitcgmxQKxlA&gtm_preview=env-2&gtm_cookies_win=x'; f.parentNode.insertBefore(j, f);
    })(window, document, 'script', 'dataLayer', 'GTM-N7BVC2W');
  </script>
  <!-- endsection --><script type="application/ld+json">
{ 
 "@context": "http://schema.org", 
 "@type": "BlogPosting",
 "headline": "How Discord Supercharges Network Disks for Extreme Low Latency",
 "image": "https://assets-global.website-files.com/5f9072399b2640f14d6a2bf4/62fa96e012a1658e5e213eb5_Untitled.png",
 "publisher": "Discord",
 "url": "https://discord.com/blog/how-discord-supercharges-network-disks-for-extreme-low-latency",
 "datePublished": "Aug 31, 2023",
 "dateCreated": "Aug 15, 2022",
 "dateModified": "Aug 25, 2023",
 "description": "Learn how Discord optimizes its platform to respond to the high frequency of queries for all types of content and data as quickly as possible.",
   "author": {
    "@type": "Person",
    "name": "Glen Oakley"
  }
 }
</script>

<script nonce="MTE0LDEzMywxMTUsMTk3LDE3MiwxMDMsNjUsNjA=">(function(){var js = "window['__CF$cv$params']={r:'83f19a15ab1a189b',t:'MTcwNDE4MzgyNi44NTQwMDA='};_cpo=document.createElement('script');_cpo.nonce='MTE0LDEzMywxMTUsMTk3LDE3MiwxMDMsNjUsNjA=',_cpo.src='../cdn-cgi/challenge-platform/h/g/scripts/jsd/74bd6362/main.js',document.getElementsByTagName('head')[0].appendChild(_cpo);";var _0xh = document.createElement('iframe');_0xh.height = 1;_0xh.width = 1;_0xh.style.position = 'absolute';_0xh.style.top = 0;_0xh.style.left = 0;_0xh.style.border = 'none';_0xh.style.visibility = 'hidden';document.body.appendChild(_0xh);function handler() {var _0xi = _0xh.contentDocument || _0xh.contentWindow.document;if (_0xi) {var _0xj = _0xi.createElement('script');_0xj.nonce = 'MTE0LDEzMywxMTUsMTk3LDE3MiwxMDMsNjUsNjA=';_0xj.innerHTML = js;_0xi.getElementsByTagName('head')[0].appendChild(_0xj);}}if (document.readyState !== 'loading') {handler();} else if (window.addEventListener) {document.addEventListener('DOMContentLoaded', handler);} else {var prev = document.onreadystatechange || function () {};document.onreadystatechange = function (e) {prev(e);if (document.readyState !== 'loading') {document.onreadystatechange = prev;handler();}};}})();</script></body>
<!-- Mirrored from discord.com/blog/how-discord-supercharges-network-disks-for-extreme-low-latency by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 02 Jan 2024 08:47:20 GMT -->
</html>